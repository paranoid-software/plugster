{"version":3,"file":"plugster.min.js","sources":["../src/plugster.js"],"sourcesContent":["class Plugster extends Object {\n\n    constructor(outlets, controllerName) {\n        super();\n\n        if (!Plugster.document) Plugster.document = $(document);\n        if (!Plugster.registry) {\n            Plugster.registry = {};\n            $('[data-controller-name]').map(function (index, val) {\n                Plugster.registry[$(val).data('controllerName').toLowerCase()] = undefined;\n            });\n        }\n        if (!Plugster.explicitSubscriptions) Plugster.explicitSubscriptions = {};\n        if (!Plugster.htmlDeclaredSubscriptions) Plugster.htmlDeclaredSubscriptions = {};\n\n        this.locales = {};\n        this.name = controllerName || this.constructor.name;\n        this._ = outlets;\n        this.childTemplates = {};\n\n        console.log(`${this.name} Controller Instantiated.`);\n    }\n\n    static plug(me) {\n\n        Plugster.registry[me.name.toLowerCase()] = me;\n\n        let allPlugstersRegistered = true;\n        Object.keys(Plugster.registry).map(function (key) {\n            if (!Plugster.registry[key]) allPlugstersRegistered = false;\n        });\n\n        if (!allPlugstersRegistered) return;\n        if (window['plugsters']) return;\n\n        // Binding HTML declared subscriptions\n        Object.keys(Plugster.registry).map(function (plugsterKey) {\n            let plugster = Plugster.registry[plugsterKey];\n            let root = Plugster.registry[plugsterKey]._.root;\n            Object.keys(root.data()).map(function (rootDataKey) {\n                let dashed = rootDataKey.replace(/[A-Z]/g, m => \"-\" + m.toLowerCase());\n                let parts = dashed.split('-');\n                if (parts.length !== 3) return null;\n                if (parts[0] !== 'on') return null;\n                let methodName = root.data(rootDataKey);\n                if (!plugster[methodName]) throw new Error(`There is no method ${methodName} within the ${plugster.name} controller !!!`);\n                let plugsterNameLowerCased = parts[1];\n                let eventNameLowerCased = parts[2];\n                if (!Plugster.registry[plugsterNameLowerCased]) throw new Error(`There is no ${plugsterNameLowerCased} controller !!!`);\n                let pubMethodsLowerCased = Object.getOwnPropertyNames(Object.getPrototypeOf(Plugster.registry[plugsterNameLowerCased])).map(methodName => {\n                    return methodName.toLowerCase();\n                });\n                if (pubMethodsLowerCased.indexOf(eventNameLowerCased) < 0) throw new Error(`There is no ${eventNameLowerCased} event in ${plugsterNameLowerCased} controller !!!`);\n                Plugster.htmlDeclaredSubscriptions[`${plugsterNameLowerCased}_${eventNameLowerCased}_${plugster.name.toLowerCase()}`] = {\n                    listener: plugster,\n                    methodName: methodName\n                };\n            });\n        });\n\n        window['plugsters'] = Plugster.registry;\n\n    }\n\n    setLocales(value) {\n        this.locales = value;\n    }\n\n    translateTo(lang, text) {\n        if (!this.locales[lang]) return text;\n        if (!this.locales[lang][text]) return text;\n        return this.locales[lang][text];\n    }\n\n    toString() {\n        return this.name;\n    }\n\n    init() {\n        let self = this;\n\n        console.log(`Initializing ${self.name} Controller.`);\n\n        let childTemplatesLoadPromises = self.bindOutlets();\n        return new window.Promise((resolve, reject) => {\n            return window.Promise.all(childTemplatesLoadPromises).then(function () {\n                console.log(`${self.name} Controller Initialized`);\n                self.afterInit();\n                resolve(self);\n            }).catch(e => {\n                reject(e);\n            });\n        });\n    }\n\n    afterInit() {\n        throw new Error('Every Plugster must implement its own afterInit method !!!');\n    }\n\n    bindOutlets() {\n\n        let self = this;\n\n        console.log(`Binding Outlets for ${self.name} Controller.`);\n\n        let childTemplatesLoadPromises = [];\n        let controllerSelectorSentence = `[data-controller-name=${self.name}]`;\n        if ($(controllerSelectorSentence).length === 0) throw new Error(`There is no view with a ${self.name} controller !!!`);\n\n        let root = $(controllerSelectorSentence);\n\n        $.map(self._, function (outlet, key) {\n\n            let selector = `[data-outlet-id='${key}']`;\n            if (root.find(selector).length === 0) throw new Error(`Outlet ${key} does not exist, check both ${self.name} view and controller !!!`);\n\n            let filteredOutlet = root.find(selector);\n            if (filteredOutlet.length > 1) {\n                let filteredOutlets = $.map(filteredOutlet, function (o) {\n                    if ($(o).closest('[data-controller-name]').data('controller-name') === self.name)\n                        return $(o);\n                    return null;\n                });\n                filteredOutlet = filteredOutlets[0];\n            }\n\n            filteredOutlet.attr('id', `${self.name}_${key}`);\n\n            if (filteredOutlet.data('child-templates')) {\n                filteredOutlet.buildListItem = function (withTemplateIndex, itemKey, jsonData, outletsSchema, itemClickCallback) {\n                    if (!this.items) this.items = {};\n                    if (!this.items[itemKey]) this.items[itemKey] = {};\n                    this.append(self.childTemplates[`${key}_${withTemplateIndex}`]);\n                    let outlets = self.compileChildTemplate(key, this.children().length - 1, this.children().last(), outletsSchema);\n                    if (outlets === null) return null;\n                    outlets.root.attr('data-key', itemKey);\n                    if (itemClickCallback)\n                        outlets.root.click(function () {\n                            itemClickCallback(itemKey, jsonData);\n                        });\n                    this.items[itemKey].outlets = outlets;\n                    this.items[itemKey].data = jsonData;\n                    return this.items[itemKey].outlets;\n                };\n                filteredOutlet.count = function () {\n                    if (!this.items) return 0;\n                    return Object.keys(this.items).length;\n                };\n                filteredOutlet.getData = function (key) {\n                    return this.items[key].data;\n                };\n                filteredOutlet.getOutlets = function (key) {\n                    return this.items[key].outlets;\n                };\n                filteredOutlet.delete = function (key) {\n                    this.children(`[data-key='${key}']`).remove();\n                    delete this.items[key];\n                };\n                filteredOutlet.clear = function () {\n                    this.items = undefined;\n                    this.children().remove();\n                };\n                let templates = filteredOutlet.data('child-templates');\n                $.map(templates, function (childTemplate, index) {\n                    let deferred = $.Deferred();\n                    childTemplatesLoadPromises.push(deferred.promise());\n                    self.loadChildTemplate(key, index, childTemplate, deferred);\n                });\n            }\n\n            self._[key] = filteredOutlet;\n\n        });\n\n        self._.root = root;\n\n        console.log(`Outlets for ${self.name} Controller were binded successfuly !!!`);\n\n        return childTemplatesLoadPromises;\n\n    }\n\n    loadChildTemplate(outletName, index, file, deferred) {\n        let self = this;\n        $.get({url: file, cache: false}, function (html) {\n            self.childTemplates[`${outletName}_${index}`] = html;\n            console.log(`Template ${file} loaded.`);\n            deferred.resolve();\n        });\n    }\n\n    compileChildTemplate(parentOutletId, childIndex, template, outletsSchema) {\n        // TODO: Validate schema compliance.\n        if (!outletsSchema || Object.keys(outletsSchema).length === 0) return null;\n        let outlets = {};\n        outlets.root = template;\n        $.map(template.find('[data-child-outlet-id]'), function (outlet) {\n            $(outlet).attr('id', `${parentOutletId}_${$(outlet).data('child-outlet-id')}_${childIndex}`);\n            outlets[$(outlet).data('child-outlet-id')] = $(outlet);\n        });\n        return outlets;\n    }\n\n    registerEventSignature(name, data, callback) {\n        if (!name) return;\n        if (!data) return;\n        if (!callback) return;\n        let unreferencedData = this.cloneDeep(data);\n        $(this).on(name, unreferencedData, callback);\n    }\n\n    dispatchEvent(name, args) {\n        let unreferencedArgs = this.cloneDeep(args);\n        this.broadcastExplicitSubscriptionsMessages(name, unreferencedArgs);\n        this.broadcastHtmlDeclaredSubscriptionsMessages(name, unreferencedArgs);\n        $(this).triggerHandler(new $.Event(name, {args: unreferencedArgs}));\n    }\n\n    // Taken from https://medium.com/weekly-webtips/deep-clone-with-vanilla-js-5ef16e0b365c\n    cloneDeep(entity, cache = new WeakMap) {\n        let self = this;\n        const referenceTypes = ['Array', 'Object', 'Map', 'Set', 'WeakMap', 'WeakSet'];\n        const entityType = Object.prototype.toString.call(entity);\n        if (!new RegExp(referenceTypes.join('|')).test(entityType)) return entity;\n        if (cache.has(entity)) {\n            return cache.get(entity);\n        }\n        const c = new entity.constructor;\n        if (entity instanceof Map || entity instanceof WeakMap) {\n            entity.forEach((value, key) => c.set(self.cloneDeep(key), self.cloneDeep(value)));\n        }\n        if (entity instanceof Set || entity instanceof WeakSet) {\n            entity.forEach((value) => c.add(self.cloneDeep(value)));\n        }\n        cache.set(entity, c);\n        return Object.assign(c, ...Object.keys(entity).map((prop) => ({[prop]: self.cloneDeep(entity[prop], cache)})));\n    }\n\n    broadcastExplicitSubscriptionsMessages(name, args) {\n        let self = this;\n        let keyPrefix = `${this.name}_${name}`.toLowerCase();\n        Object.keys(Plugster.explicitSubscriptions).map(function (key) {\n            if (key.startsWith(keyPrefix)) {\n                if (!Plugster.explicitSubscriptions[key]['onNewMessage']) throw new Error('Subscriber must implement onNewMessage method.');\n                Plugster.explicitSubscriptions[key]['onNewMessage'](self.name, name, args);\n            }\n        });\n    }\n\n    broadcastHtmlDeclaredSubscriptionsMessages(name, args) {\n        let keyPrefix = `${this.name}_${name}`.toLowerCase();\n        Object.keys(Plugster.htmlDeclaredSubscriptions).map(function (key) {\n            if (key.startsWith(keyPrefix)) {\n                let sub = Plugster.htmlDeclaredSubscriptions[key];\n                sub.listener[sub.methodName].call(sub.listener, args);\n            }\n        });\n    }\n\n    // Explicit subscriptions enrollment, you will need a default listener on the subscriber called onNewMessage\n    // to use this kind of subscriptions\n    listenTo(pubPlugster, event) {\n        Plugster.explicitSubscriptions[`${pubPlugster.name}_${event.name}_${this.name}`.toLowerCase()] = this;\n    }\n\n    static createView(controllerName, htmlTemplateFile, callback) {\n        $.get({url: htmlTemplateFile, cache: false}, function (html) {\n            callback(html.replace('[CONTROLLER_NAME]', controllerName));\n        });\n    }\n\n}\n\nexport {Plugster}\n"],"names":["Plugster","Object","constructor","outlets","controllerName","super","document","$","registry","map","index","val","data","toLowerCase","undefined","explicitSubscriptions","htmlDeclaredSubscriptions","this","locales","name","_","childTemplates","console","log","plug","me","allPlugstersRegistered","keys","key","window","plugsterKey","plugster","root","rootDataKey","parts","replace","m","split","length","methodName","Error","plugsterNameLowerCased","eventNameLowerCased","getOwnPropertyNames","getPrototypeOf","indexOf","listener","setLocales","value","translateTo","lang","text","toString","init","self","childTemplatesLoadPromises","bindOutlets","Promise","resolve","reject","all","then","afterInit","catch","e","controllerSelectorSentence","outlet","selector","find","filteredOutlet","o","closest","attr","buildListItem","withTemplateIndex","itemKey","jsonData","outletsSchema","itemClickCallback","items","append","compileChildTemplate","children","last","click","count","getData","getOutlets","delete","remove","clear","templates","childTemplate","deferred","Deferred","push","promise","loadChildTemplate","outletName","file","get","url","cache","html","parentOutletId","childIndex","template","registerEventSignature","callback","unreferencedData","cloneDeep","on","dispatchEvent","args","unreferencedArgs","broadcastExplicitSubscriptionsMessages","broadcastHtmlDeclaredSubscriptionsMessages","triggerHandler","Event","entity","WeakMap","entityType","prototype","call","RegExp","join","test","has","c","Map","forEach","set","Set","WeakSet","add","assign","prop","keyPrefix","startsWith","sub","listenTo","pubPlugster","event","createView","htmlTemplateFile"],"mappings":"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"}